# Описание приложения.
Приложение представляет собой REST API сервис, позволяющий совершать CRUD операции с сущностью пользователь и должность.

Приложение написано на FastAPI.

Приложение поддерживает использование реляционной СУБД PostgreSQL и нереляционной Redis.

Прилоение состоит из fastapi приложения и консольного.

Для запуска приложения локально, необходимы запущенные серверы PostgreSQL или Redis в зависимости от выбранного типа СУБД.
## Взаимодействие с fastapi приложением.
После запуска fastapi приложения с ним можно взаимодействовать перейдя по ссылке "http://хост:порт/docs"

Инструкции по запуску приложения приведены ниже.
## Описание выбора типа СУБД.
В приложении реализовано два репозитория для работы с данными.

Один репозиторий взаимодействует с PostgreSQL, другой с Redis.

Для выбора СУБД PostgreSQL, нужно присвоить переменной окружения "NO_SQL" значение False.

Для выбора СУБД Redis, нужно присвоить переменной окружения "NO_SQL" значение True.

Переменная окружения "NO_SQL" хранится в файлe "/env_files/.env-gen-settings".
## Описание технологий, примененных в приложении.
Приложение написано на FastAPI.

Есть возможность использовать СУБД PostgreSQL или Redis.

Сборщик зависимостей- Poetry.
## Описание структуры приложения.
### Конфигурация приложения
Основная конфигурация приложения находится в файле "app/config/general_settings.py".

Конфигурация fastapi прилодения находится в файле "app/config/fastapi_app_settings.py".

Конфигурайия СУБД PostgreSQL находится в файле "app/config/postgre_settings.py".

Пути до .env файлов с переменными окружения находятся в файле "app/config/paths_to_settings_files.py" в классе "PathToSettingsFiles".

Класс, объединяющий конфигурацию приложения находится в файле "app/config/settings_store.py".

.env файл с основной конфигурацией приложения - "/env_files/.env-gen-settings".

.env файл с конфигурацией fastapi приложения- "/env_files/.env-fastapi-app-settings"

.env файл с конфигурацией СУБД PostgreSQL- "/env_files/.env-postgre-settings".
### Взаимодействие с Redis.
Логика работы с Redis- "/app/data_sources/storages/manage_redis/manage_redis.py"
### Работа с данными сущности должность.
Репозитоий для сущности должность с использованием нереляционной СУБД- "/app/data_sources/storages/position_repo/position_repo_no_sql".

Репозитоий для сущности должность с использованием реляционной СУБД- "/app/data_sources/storages/position_repo/position_repo_sql".
### Работа с данными сущности пользователь.
Репозитоий для сущности пользователь с использованием нереляционной СУБД- "/app/data_sources/storages/user_repo/user_repo_no_sql".

Репозитоий для сущности пользователь с использованием реляционной СУБД- "/app/data_sources/storages/user_repo/user_repo_sql".
### Модели Pydantic.
Модели Pydantic находятся в "/app/pydantic_models".
### Сервисы
Сервис для сущности должность- "/app/service/service_for_positions.py".

Сервис для сущности пользователь- "/app/service/service_for_users.py"
### Обработчики запросов.
Обработчики запросов для сущности должность находятся в "app/views/crud_for_pos-s".

Обработчики запросов для сущности пользователь находятся в "app/views/crud_for_user".
### Консольное приложение.
Логика работы консольного приложения находится в файле "/app/console_app.py".

Запуск консольного приложения осуществляется из файла "/app/launch_console_app.py".
### Fastapi приложение.
Класс, хранящий экземпляр fastapi приложения находится в файле "/app/fast_app.py".

Запуск fastapi приложения осуществляется из файла "/app/launch_fastapi_app.py".

Логика при старте и остановке fastapi приложения находится в файле "/app/lifespan.py".
### Создание таблиц базы данных.
Создание таблицы для сущности должность осуществляется из файла "/app/create_position_table.py".

Создание таблицы для сущности пользователь осуществляется из файла "/app/create_user_table.py".

# Запуск приложения локально.
## Подготовка к запуску приложнния.
Для работы приложения, необходимы запущенные серверы PostgreSQL или Redis в завсисмости от выбранного типа СУБД.
### Установка зависимостей.
Для установки зависимостей необходимо выполнить команду "poetry install" в терминале из корневой директории.
### Активация виртуального окружения.
Для активации виртуального окружения необходимо выполнить команду "poetry shell" в терминале из корневой директории.
### Создание таблиц базы данных.
Для создания таблиц базы данных необходимо задать значение "False" переменной окружения "NO_SQL" в файле "/env_files/.env_gen_settings".

Так же необходимо задать значения следующим переменным окружения в файле "/env_files/.env-postgre-settings":

  - DB_USER- имя пользователя базы данных,

  - PASSWORD- пароль для базы данных,

  - DB_HOST- хост базы данных,

  - DB_NAME- имя базы данных,

  - DB_PORT- порт базы данных.
  
После этого необходимо выполнить команду "python create_position_table.py" для создания таблицы для сущности должность и
"python create_user.py" для создания таблицы для сущности пользователь в терминале из директории "/app".
## Запуск fastapi приложения с использованием реляционной СУБД.
Перед запуском fastapi приложения необходимо установить значение "False" для переменной окружения "NO_SQL" в
файле "/env_files/.env-gen-settings".

Так же необходимо установить значение "False" для переменной окружения "IS_CONSOLE_APP" в файле "/env_files/.env-gen-settings".

Так же необходимо установить значения для следующих переменных окружения в файле "/env_files/.env-fastapi_app_settings":

  - APP_HOST- хост для запуска приложения;

  - APP_PORT- порт для запуска приложения.

Для запуска fastapi приложения необходимо выполнить команду "python launch_fastapi_app.py" в терминале из директории "/app".
## Запуск fastapi приложения с использованием нереляционной СУБД.
Перед запуском fastapi приложения необходимо установить значение "True" для переменной окружения "NO_SQL" в
файле "/env_files/.env-gen-settings".

Так же необходимо установить значение "False" для переменной окружения "IS_CONSOLE_APP" в файле "/env_files/.env-gen-settings".

Так же необходимо установить значения для следующих переменных окружения в файле "/env_files/.env-fastapi_app_settings":

  - APP_HOST- хост для запуска приложения;

  - APP_PORT- порт для запуска приложения.

Для запуска fastapi приложения необходимо выполнить команду "python launch_fastapi_app.py" в терминале из директории "/app".
## Запуск консольного приложения с использованием реляционной СУБД.
Перед запуском приложения необходимо установить значение "False" для переменной окружения "NO_SQL" в
файле "/env_files/.env-gen-settings".

Так же необходимо установить значение "True" для переменной окружения "IS_CONSOLE_APP" в файле "/env_files/.env-gen-settings".

Для запуска приложения необходимо выполнить команду "python launch_console_app.py" в терминале из директории "/app".
## Запуск консольного приложения с использованием нереляционной СУБД.
Перед запуском приложения необходимо установить значение "True" для переменной окружения "NO_SQL" в
файле "/env_files/.env-gen-settings".

Так же необходимо установить значение "True" для переменной окружения "IS_CONSOLE_APP" в файле "/env_files/.env-gen-settings".

Для запуска приложения необходимо выполнить команду "python launch_console_app.py" в терминале из директории "/app".
